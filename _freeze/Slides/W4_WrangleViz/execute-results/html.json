{
  "hash": "466f461d5df4115de0fcc4b08e595798",
  "result": {
    "markdown": "---\ntitle: \"W4_WrangleViz\"\nsubtitle: |\n   | R Coding Club \n   | RTG 2660\nauthor: \"Dr. Lea Hildebrandt\"\ndate: 2024/02/14\ndescription: \"Getting the raw data in a useful format\"\nformat: \n  revealjs:\n    smaller: true\n    scrollable: true\n    slide-number: true\n    theme: simple\n    chalkboard: true\neditor: visual\nfrom: markdown+emoji\n---\n\n\n# More Data Wrangling & First Visualizations\n\n## Warm-up\n\nWho has practiced a bit, and what did you cover?\n\n. . .\n\nDid anyone bring a problem?\n\n`{r} #| echo: false} library(tidyverse)`\n\n\n::: {.cell}\n<style type=\"text/css\">\ncode.sourceCode {   font-size: 1.4em; }  \ndiv.cell-output-stdout {   font-size: 1.4em; }\n</style>\n:::\n\n\n. . .\n\nIf I type this code into the console (and run it), I will get the following error. Why?\n\n```         \nlibrary(babynames)  \ndat <- summarise(.data = babynames, mean_n = mean(n))  \n\nError in summarise(.data = babynames, mean_n = mean(n)) :    could not find function \"summarise\"\n```\n\n. . .\n\nWhich function(s) would you use to calculate reaction times per subject?\n\n. . .\n\nHow do you merge two data sets?\n\n## Valentines Day!\n\nLet's work with a \"romantic\" data set today! :D\n\nI found this huge data set on speed dating online, plus it's codebook. Let's check it out.\n\n. . .\n\nFirst, we need to load the data. For this, there are a variety of functions (also for reading in specialized files). Since it is a basic .csv file, we can use \\`read_data()\\` (from the tidyverse):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nspeed_dating <- read_csv(\"Data/Speed Dating Data.csv\")\n\n# check out data structure\nstr(speed_dating)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nspc_tbl_ [8,378 Ã— 195] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ iid     : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ id      : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ gender  : num [1:8378] 0 0 0 0 0 0 0 0 0 0 ...\n $ idg     : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ condtn  : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ wave    : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ round   : num [1:8378] 10 10 10 10 10 10 10 10 10 10 ...\n $ position: num [1:8378] 7 7 7 7 7 7 7 7 7 7 ...\n $ positin1: num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ order   : num [1:8378] 4 3 10 5 7 6 1 2 8 9 ...\n $ partner : num [1:8378] 1 2 3 4 5 6 7 8 9 10 ...\n $ pid     : num [1:8378] 11 12 13 14 15 16 17 18 19 20 ...\n $ match   : num [1:8378] 0 0 1 1 1 0 0 0 1 0 ...\n $ int_corr: num [1:8378] 0.14 0.54 0.16 0.61 0.21 0.25 0.34 0.5 0.28 -0.36 ...\n $ samerace: num [1:8378] 0 0 1 0 0 0 0 0 0 0 ...\n $ age_o   : num [1:8378] 27 22 22 23 24 25 30 27 28 24 ...\n $ race_o  : num [1:8378] 2 2 4 2 3 2 2 2 2 2 ...\n $ pf_o_att: num [1:8378] 35 60 19 30 30 ...\n $ pf_o_sin: num [1:8378] 20 0 18 5 10 ...\n $ pf_o_int: num [1:8378] 20 0 19 15 20 ...\n $ pf_o_fun: num [1:8378] 20 40 18 40 10 ...\n $ pf_o_amb: num [1:8378] 0 0 14 5 10 ...\n $ pf_o_sha: num [1:8378] 5 0 12 5 20 ...\n $ dec_o   : num [1:8378] 0 0 1 1 1 1 0 0 1 0 ...\n $ attr_o  : num [1:8378] 6 7 10 7 8 7 3 6 7 6 ...\n $ sinc_o  : num [1:8378] 8 8 10 8 7 7 6 7 7 6 ...\n $ intel_o : num [1:8378] 8 10 10 9 9 8 7 5 8 6 ...\n $ fun_o   : num [1:8378] 8 7 10 8 6 8 5 6 8 6 ...\n $ amb_o   : num [1:8378] 8 7 10 9 9 7 8 8 8 6 ...\n $ shar_o  : num [1:8378] 6 5 10 8 7 7 7 6 9 6 ...\n $ like_o  : num [1:8378] 7 8 10 7 8 7 2 7 6.5 6 ...\n $ prob_o  : num [1:8378] 4 4 10 7 6 6 1 5 8 6 ...\n $ met_o   : num [1:8378] 2 2 1 2 2 2 2 2 2 2 ...\n $ age     : num [1:8378] 21 21 21 21 21 21 21 21 21 21 ...\n $ field   : chr [1:8378] \"Law\" \"Law\" \"Law\" \"Law\" ...\n $ field_cd: num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ undergra: chr [1:8378] NA NA NA NA ...\n $ mn_sat  : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ tuition : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ race    : num [1:8378] 4 4 4 4 4 4 4 4 4 4 ...\n $ imprace : num [1:8378] 2 2 2 2 2 2 2 2 2 2 ...\n $ imprelig: num [1:8378] 4 4 4 4 4 4 4 4 4 4 ...\n $ from    : chr [1:8378] \"Chicago\" \"Chicago\" \"Chicago\" \"Chicago\" ...\n $ zipcode : num [1:8378] 60521 60521 60521 60521 60521 ...\n $ income  : num [1:8378] 69487 69487 69487 69487 69487 ...\n $ goal    : num [1:8378] 2 2 2 2 2 2 2 2 2 2 ...\n $ date    : num [1:8378] 7 7 7 7 7 7 7 7 7 7 ...\n $ go_out  : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ career  : chr [1:8378] \"lawyer\" \"lawyer\" \"lawyer\" \"lawyer\" ...\n $ career_c: num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ sports  : num [1:8378] 9 9 9 9 9 9 9 9 9 9 ...\n $ tvsports: num [1:8378] 2 2 2 2 2 2 2 2 2 2 ...\n $ exercise: num [1:8378] 8 8 8 8 8 8 8 8 8 8 ...\n $ dining  : num [1:8378] 9 9 9 9 9 9 9 9 9 9 ...\n $ museums : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ art     : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ hiking  : num [1:8378] 5 5 5 5 5 5 5 5 5 5 ...\n $ gaming  : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ clubbing: num [1:8378] 5 5 5 5 5 5 5 5 5 5 ...\n $ reading : num [1:8378] 6 6 6 6 6 6 6 6 6 6 ...\n $ tv      : num [1:8378] 9 9 9 9 9 9 9 9 9 9 ...\n $ theater : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ movies  : num [1:8378] 10 10 10 10 10 10 10 10 10 10 ...\n $ concerts: num [1:8378] 10 10 10 10 10 10 10 10 10 10 ...\n $ music   : num [1:8378] 9 9 9 9 9 9 9 9 9 9 ...\n $ shopping: num [1:8378] 8 8 8 8 8 8 8 8 8 8 ...\n $ yoga    : num [1:8378] 1 1 1 1 1 1 1 1 1 1 ...\n $ exphappy: num [1:8378] 3 3 3 3 3 3 3 3 3 3 ...\n $ expnum  : num [1:8378] 2 2 2 2 2 2 2 2 2 2 ...\n $ attr1_1 : num [1:8378] 15 15 15 15 15 15 15 15 15 15 ...\n $ sinc1_1 : num [1:8378] 20 20 20 20 20 20 20 20 20 20 ...\n $ intel1_1: num [1:8378] 20 20 20 20 20 20 20 20 20 20 ...\n $ fun1_1  : num [1:8378] 15 15 15 15 15 15 15 15 15 15 ...\n $ amb1_1  : num [1:8378] 15 15 15 15 15 15 15 15 15 15 ...\n $ shar1_1 : num [1:8378] 15 15 15 15 15 15 15 15 15 15 ...\n $ attr4_1 : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ sinc4_1 : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ intel4_1: num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ fun4_1  : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ amb4_1  : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ shar4_1 : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ attr2_1 : num [1:8378] 35 35 35 35 35 35 35 35 35 35 ...\n $ sinc2_1 : num [1:8378] 20 20 20 20 20 20 20 20 20 20 ...\n $ intel2_1: num [1:8378] 15 15 15 15 15 15 15 15 15 15 ...\n $ fun2_1  : num [1:8378] 20 20 20 20 20 20 20 20 20 20 ...\n $ amb2_1  : num [1:8378] 5 5 5 5 5 5 5 5 5 5 ...\n $ shar2_1 : num [1:8378] 5 5 5 5 5 5 5 5 5 5 ...\n $ attr3_1 : num [1:8378] 6 6 6 6 6 6 6 6 6 6 ...\n $ sinc3_1 : num [1:8378] 8 8 8 8 8 8 8 8 8 8 ...\n $ fun3_1  : num [1:8378] 8 8 8 8 8 8 8 8 8 8 ...\n $ intel3_1: num [1:8378] 8 8 8 8 8 8 8 8 8 8 ...\n $ amb3_1  : num [1:8378] 7 7 7 7 7 7 7 7 7 7 ...\n $ attr5_1 : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ sinc5_1 : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ intel5_1: num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ fun5_1  : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ amb5_1  : num [1:8378] NA NA NA NA NA NA NA NA NA NA ...\n $ dec     : num [1:8378] 1 1 1 1 1 0 1 0 1 1 ...\n $ attr    : num [1:8378] 6 7 5 7 5 4 7 4 7 5 ...\n  [list output truncated]\n - attr(*, \"spec\")=\n  .. cols(\n  ..   iid = col_double(),\n  ..   id = col_double(),\n  ..   gender = col_double(),\n  ..   idg = col_double(),\n  ..   condtn = col_double(),\n  ..   wave = col_double(),\n  ..   round = col_double(),\n  ..   position = col_double(),\n  ..   positin1 = col_double(),\n  ..   order = col_double(),\n  ..   partner = col_double(),\n  ..   pid = col_double(),\n  ..   match = col_double(),\n  ..   int_corr = col_double(),\n  ..   samerace = col_double(),\n  ..   age_o = col_double(),\n  ..   race_o = col_double(),\n  ..   pf_o_att = col_double(),\n  ..   pf_o_sin = col_double(),\n  ..   pf_o_int = col_double(),\n  ..   pf_o_fun = col_double(),\n  ..   pf_o_amb = col_double(),\n  ..   pf_o_sha = col_double(),\n  ..   dec_o = col_double(),\n  ..   attr_o = col_double(),\n  ..   sinc_o = col_double(),\n  ..   intel_o = col_double(),\n  ..   fun_o = col_double(),\n  ..   amb_o = col_double(),\n  ..   shar_o = col_double(),\n  ..   like_o = col_double(),\n  ..   prob_o = col_double(),\n  ..   met_o = col_double(),\n  ..   age = col_double(),\n  ..   field = col_character(),\n  ..   field_cd = col_double(),\n  ..   undergra = col_character(),\n  ..   mn_sat = col_number(),\n  ..   tuition = col_number(),\n  ..   race = col_double(),\n  ..   imprace = col_double(),\n  ..   imprelig = col_double(),\n  ..   from = col_character(),\n  ..   zipcode = col_number(),\n  ..   income = col_number(),\n  ..   goal = col_double(),\n  ..   date = col_double(),\n  ..   go_out = col_double(),\n  ..   career = col_character(),\n  ..   career_c = col_double(),\n  ..   sports = col_double(),\n  ..   tvsports = col_double(),\n  ..   exercise = col_double(),\n  ..   dining = col_double(),\n  ..   museums = col_double(),\n  ..   art = col_double(),\n  ..   hiking = col_double(),\n  ..   gaming = col_double(),\n  ..   clubbing = col_double(),\n  ..   reading = col_double(),\n  ..   tv = col_double(),\n  ..   theater = col_double(),\n  ..   movies = col_double(),\n  ..   concerts = col_double(),\n  ..   music = col_double(),\n  ..   shopping = col_double(),\n  ..   yoga = col_double(),\n  ..   exphappy = col_double(),\n  ..   expnum = col_double(),\n  ..   attr1_1 = col_double(),\n  ..   sinc1_1 = col_double(),\n  ..   intel1_1 = col_double(),\n  ..   fun1_1 = col_double(),\n  ..   amb1_1 = col_double(),\n  ..   shar1_1 = col_double(),\n  ..   attr4_1 = col_double(),\n  ..   sinc4_1 = col_double(),\n  ..   intel4_1 = col_double(),\n  ..   fun4_1 = col_double(),\n  ..   amb4_1 = col_double(),\n  ..   shar4_1 = col_double(),\n  ..   attr2_1 = col_double(),\n  ..   sinc2_1 = col_double(),\n  ..   intel2_1 = col_double(),\n  ..   fun2_1 = col_double(),\n  ..   amb2_1 = col_double(),\n  ..   shar2_1 = col_double(),\n  ..   attr3_1 = col_double(),\n  ..   sinc3_1 = col_double(),\n  ..   fun3_1 = col_double(),\n  ..   intel3_1 = col_double(),\n  ..   amb3_1 = col_double(),\n  ..   attr5_1 = col_double(),\n  ..   sinc5_1 = col_double(),\n  ..   intel5_1 = col_double(),\n  ..   fun5_1 = col_double(),\n  ..   amb5_1 = col_double(),\n  ..   dec = col_double(),\n  ..   attr = col_double(),\n  ..   sinc = col_double(),\n  ..   intel = col_double(),\n  ..   fun = col_double(),\n  ..   amb = col_double(),\n  ..   shar = col_double(),\n  ..   like = col_double(),\n  ..   prob = col_double(),\n  ..   met = col_double(),\n  ..   match_es = col_double(),\n  ..   attr1_s = col_double(),\n  ..   sinc1_s = col_double(),\n  ..   intel1_s = col_double(),\n  ..   fun1_s = col_double(),\n  ..   amb1_s = col_double(),\n  ..   shar1_s = col_double(),\n  ..   attr3_s = col_double(),\n  ..   sinc3_s = col_double(),\n  ..   intel3_s = col_double(),\n  ..   fun3_s = col_double(),\n  ..   amb3_s = col_double(),\n  ..   satis_2 = col_double(),\n  ..   length = col_double(),\n  ..   numdat_2 = col_double(),\n  ..   attr7_2 = col_double(),\n  ..   sinc7_2 = col_double(),\n  ..   intel7_2 = col_double(),\n  ..   fun7_2 = col_double(),\n  ..   amb7_2 = col_double(),\n  ..   shar7_2 = col_double(),\n  ..   attr1_2 = col_double(),\n  ..   sinc1_2 = col_double(),\n  ..   intel1_2 = col_double(),\n  ..   fun1_2 = col_double(),\n  ..   amb1_2 = col_double(),\n  ..   shar1_2 = col_double(),\n  ..   attr4_2 = col_double(),\n  ..   sinc4_2 = col_double(),\n  ..   intel4_2 = col_double(),\n  ..   fun4_2 = col_double(),\n  ..   amb4_2 = col_double(),\n  ..   shar4_2 = col_double(),\n  ..   attr2_2 = col_double(),\n  ..   sinc2_2 = col_double(),\n  ..   intel2_2 = col_double(),\n  ..   fun2_2 = col_double(),\n  ..   amb2_2 = col_double(),\n  ..   shar2_2 = col_double(),\n  ..   attr3_2 = col_double(),\n  ..   sinc3_2 = col_double(),\n  ..   intel3_2 = col_double(),\n  ..   fun3_2 = col_double(),\n  ..   amb3_2 = col_double(),\n  ..   attr5_2 = col_double(),\n  ..   sinc5_2 = col_double(),\n  ..   intel5_2 = col_double(),\n  ..   fun5_2 = col_double(),\n  ..   amb5_2 = col_double(),\n  ..   you_call = col_double(),\n  ..   them_cal = col_double(),\n  ..   date_3 = col_double(),\n  ..   numdat_3 = col_double(),\n  ..   num_in_3 = col_double(),\n  ..   attr1_3 = col_double(),\n  ..   sinc1_3 = col_double(),\n  ..   intel1_3 = col_double(),\n  ..   fun1_3 = col_double(),\n  ..   amb1_3 = col_double(),\n  ..   shar1_3 = col_double(),\n  ..   attr7_3 = col_double(),\n  ..   sinc7_3 = col_double(),\n  ..   intel7_3 = col_double(),\n  ..   fun7_3 = col_double(),\n  ..   amb7_3 = col_double(),\n  ..   shar7_3 = col_double(),\n  ..   attr4_3 = col_double(),\n  ..   sinc4_3 = col_double(),\n  ..   intel4_3 = col_double(),\n  ..   fun4_3 = col_double(),\n  ..   amb4_3 = col_double(),\n  ..   shar4_3 = col_double(),\n  ..   attr2_3 = col_double(),\n  ..   sinc2_3 = col_double(),\n  ..   intel2_3 = col_double(),\n  ..   fun2_3 = col_double(),\n  ..   amb2_3 = col_double(),\n  ..   shar2_3 = col_double(),\n  ..   attr3_3 = col_double(),\n  ..   sinc3_3 = col_double(),\n  ..   intel3_3 = col_double(),\n  ..   fun3_3 = col_double(),\n  ..   amb3_3 = col_double(),\n  ..   attr5_3 = col_double(),\n  ..   sinc5_3 = col_double(),\n  ..   intel5_3 = col_double(),\n  ..   fun5_3 = col_double(),\n  ..   amb5_3 = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n:::\n:::\n\n\n## Removing irrelevant columns\n\nWe have 195 columns, it's hard to understand what they mean and have an overview. Let's have a look at the Codebook and decide which columns we want to keep. What do you find interesting?\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspeed_dating2 <- speed_dating %>% \n  select(iid, gender, condtn, wave, round, pid, match, int_corr, age, age_o, dec_o, field_cd, goal, sports, dining, art, attr1_1, sinc1_1, intel1_1, fun1_1, amb1_1, shar1_1, attr1_2, sinc1_2, intel1_2, fun1_2, amb1_2, shar1_2, attr1_3, sinc1_3, intel1_3, fun1_3, amb1_3, shar1_3,  attr7_2, sinc7_2, intel7_2, fun7_2, amb7_2, shar7_2, attr7_3, sinc7_3, intel7_3, fun7_3, amb7_3, shar7_3)\n```\n:::\n\n\n## Renaming columns\n\nThese column names might not be very helpful to remember what the names stand for. If you want to, try to change the names of a few of these columns!\n\n. . .\n\nYou could do that while selecting the columns already, but afterwards also works:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspeed_dating2 <- speed_dating2 %>% \n  rename(partner_iid = pid)\n```\n:::\n\n\n## Is this data frame in a tidy format?\n\nTidy data: Data that is easily processed by tidyverse functions (and often the required format for statistical analyses and data visualizations).\n\nThree principles:\n\n-   Each variable has its own column.\n\n-   Each observation has its own row.\n\n-   Each value has its own cell.\n\n. . .\n\nWide vs. long format data?\n\n-   Wide format: Each participant/animal... has one row, observations per participant are in columns.\n\n-   Long format: Each observation = own row. (Likely several rows per participant: Trials etc.)\n\n::: columns\n::: column\n| ID  | Time_1 | Time_2 |\n|-----|--------|--------|\n| a1  | 230    | 310    |\n| a2  | 195    | 220    |\n| a3  | 245    | 290    |\n:::\n\n::: column\n| ID  | Time | Value |\n|-----|------|-------|\n| a1  | 1    | 230   |\n| a1  | 2    | 310   |\n| a2  | 1    | 195   |\n| a3  | 2    | 220   |\n| a3  | 1    | 245   |\n| a3  | 2    | 290   |\n:::\n:::\n\nData often does not come in this format but is rather messy! That's why we wrangle.\n\nTidy data is in between wide and long (you can always go longer! :D)\n\n## Tidy Data 2\n\nWhat do you think, which of the following data sets is tidy?\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 4\n  country      year  cases population\n  <chr>       <dbl>  <dbl>      <dbl>\n1 Afghanistan  1999    745   19987071\n2 Afghanistan  2000   2666   20595360\n3 Brazil       1999  37737  172006362\n4 Brazil       2000  80488  174504898\n5 China        1999 212258 1272915272\n6 China        2000 213766 1280428583\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 Ã— 4\n   country      year type            count\n   <chr>       <dbl> <chr>           <dbl>\n 1 Afghanistan  1999 cases             745\n 2 Afghanistan  1999 population   19987071\n 3 Afghanistan  2000 cases            2666\n 4 Afghanistan  2000 population   20595360\n 5 Brazil       1999 cases           37737\n 6 Brazil       1999 population  172006362\n 7 Brazil       2000 cases           80488\n 8 Brazil       2000 population  174504898\n 9 China        1999 cases          212258\n10 China        1999 population 1272915272\n11 China        2000 cases          213766\n12 China        2000 population 1280428583\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 3\n  country      year rate             \n  <chr>       <dbl> <chr>            \n1 Afghanistan  1999 745/19987071     \n2 Afghanistan  2000 2666/20595360    \n3 Brazil       1999 37737/172006362  \n4 Brazil       2000 80488/174504898  \n5 China        1999 212258/1272915272\n6 China        2000 213766/1280428583\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 Ã— 5\n  country     `1999_cases` `2000_cases` `1999_population` `2000_population`\n  <chr>              <dbl>        <dbl>             <dbl>             <dbl>\n1 Afghanistan          745         2666          19987071          20595360\n2 Brazil             37737        80488         172006362         174504898\n3 China             212258       213766        1272915272        1280428583\n```\n:::\n:::\n\n\n## Tidying the speed dating data\n\nIf you selected columns that represent different time points (e.g. attr1_1 to attr1_3), you'd have repeated measures that you'd want to have in long format. How do you reshape the data?\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd_long1 <- speed_dating2 %>% \n  pivot_longer(cols = starts_with(\"attr1\"), names_to = \"timepoint\", values_to = \"attractive\")\n\n# do it for several columns\nsd_long2 <- speed_dating2 %>% \n  pivot_longer(cols = starts_with(c(\"attr1\", \"fun1\", \"intel1\", \"amb1\", \"shar1\", \"sinc1\")), names_to = c(\".value\", \"timepoint\"),  names_sep = \"_\")\n\n# or you could do it separately as above and then join the datasets! Good for practicing joins! :)\n```\n:::\n\n\n## Calculating the average ratings\n\nWe might want to calculate the average of the ratings, e.g. attractiveness across time points.\n\nFirst of all, unfortunately the ratings are on different scales between waves:\n\n> Waves 6-9: Please rate the importance of the following attributes in a potential date on a scale of 1-10 (1=not at all important, 10=extremely important):\n>\n> Waves 1-5, 10-21: You have 100 points to distribute among the following attributes -- give more points to those attributes that are more important in a potential date, and fewer points to those attributes that are less important in a potential date.Â  Total points must equal 100.\n\nBring these ratings on scales that are somewhat comparable!\n\n. . .\n\nNow calculate the average ratings across time points per speed dater.\n\nWe can either do so before bringing it in long format using \\`mutate()\\` or afterwards using group_by() and summarise().\n\n## Filtering the speed daters\n\nMake a new data frame that only consists of female speed daters! Also filter out those where the partner is older than the speed dater.\n\n## Sort the data frame\n\nSort the data frame based on the correlation between the interests, from highest to lowest.\n\n## Visualize!\n\nSmall Intro â€“\\> Visualization Slides!\n\n. . .\n\nWhy should we visualize our data?\n\n::: incremental\n-   check whether data make sense (unusual observations?)\n\n-   honestly present the data\n\n-   check whether data fits the assumptions of statistical tests\n:::\n\n. . .\n\nIt's fun! (And plots are probably the most important information in papers!)\n\n## ggplot\n\nWe will use a package called `ggplot2` (which is part of the tidyverse). ggplot2 is a very versatile package and allows us to make beautiful, publication ready figures.\n\nThe main function to \"start\" plotting is `ggplot()` - we will then add layers of data and layers to tweak the appearance.\n\n![](images/ggplotlayers.PNG){fig-alt=\"Depiction of how a plot is built up from different layers in ggplot2\" width=\"502\"}\n\n## What do we want to plot?\n\nHow about attractiveness ratings over time? Or gender distribution?\n\nWhat kind of plot do we need/how can we visualize it best?\n\n. . .\n\nLet's start with a simple bar chart of the gender distribution (counts)!\n\n## The First Layer\n\n-   The first line (or layer) sets up the base of the graph: the data to use and the aesthetics (what will go on the x and y axis, how the plot will be grouped).\n\n-   `aes()` can take both an `x` and `y` argument, however, with a bar chart you are just asking R to count the number of data points in each group so you don't need to specify this.\n\n\n::: {.cell output-location='column-fragment'}\n\n```{.r .cell-code}\nggplot(sd_long2, aes(x = gender))  # obviously don't use the filtered data \n```\n\n::: {.cell-output-display}\n![](W4_WrangleViz_files/figure-revealjs/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n\n\n## The Second Layer\n\nThe next layer adds a **geom** or a shape, in this case we use `geom_bar()` as we want to draw a bar plot.\n\n-   Note that we are adding layers, using a [`+`](https://rdrr.io/r/base/Arithmetic.html) between layers. This is a very important difference between pipes and visualization.\n\n\n::: {.cell output-location='column-fragment'}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\nggplot(sd_long2, aes(x = gender)) +   \n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](W4_WrangleViz_files/figure-revealjs/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n\n. . .\n\n-   Adding `fill` to the first layer will separate the data into each level of the grouping variable and give it a different colour. In this case, there is a different coloured bar for each level of `gender`.\n\n-   We can get rid of the (in this case redundant legend) with `show.legend = FALSE`.\n\n\n::: {.cell output-location='column-fragment'}\n\n```{.r .cell-code  code-line-numbers=\"1|2\"}\nggplot(sd_long2, aes(x = gender, fill=gender)) +   \n  geom_bar(show.legend = FALSE)\n```\n\n::: {.cell-output-display}\n![](W4_WrangleViz_files/figure-revealjs/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n## The Next Layers - Improving the Plot\n\nWe might want to make the plot a bit prettier and easier to read. What would you improve?\n\n. . .\n\nWe might want to add better axis labels and change the colors of the bars. We can do so with the functions `scale_x_discrete()` and `scale_y_continuous()`, which will adjust the x and y axes.\n\nWe will use these two arguments in those functions:\n\n-   `name` controls/overwrites the axis name (e.g. Groups)\n\n-   `labels` controls the break points on the axis, i.e. what are the conditions called? The order is important here!\n\n\n::: {.cell output-location='column-fragment'}\n\n```{.r .cell-code  code-line-numbers=\"3,4|5\"}\nggplot(sd_long2, aes(x = gender, fill=gender)) + \n  geom_bar(show.legend = FALSE) +   \n  scale_x_discrete(name = \"Gender\",                     \n                   labels = c(\"Female\", \"Male\")) +   # make sure this is correct\n  scale_y_continuous(name = \"Number of speed daters\")\n```\n\n::: {.cell-output-display}\n![](W4_WrangleViz_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\nThere's also the counterparts `scale_x_continuous()` and `scale_y_discrete()`. What do you think, why do we use the ones mentioned above and when would we use the other ones?\n\n## Themes: Changing the Appearance\n\nThere are a number of built-in themes that you can use to change the appearance (background, whether axes are shown etc.), but you can also tweak the themes further manually.\n\nWe will now change the default theme to `theme_minimal()`, but you can also try other themes (just type \"theme\\_\" and see what the autocomplete brings up).\n\n\n::: {.cell output-location='column-fragment'}\n\n```{.r .cell-code  code-line-numbers=\"6\"}\nggplot(sd_long2, aes(x = gender, fill=gender)) +   \n  geom_bar(show.legend = FALSE) +   \n  scale_x_discrete(name = \"Participant Sex\",                     \n                   labels = c(\"Female\", \"Male\")) +   \n  scale_y_continuous(name = \"Number of participants\") +   \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](W4_WrangleViz_files/figure-revealjs/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\n## Colors\n\nThere are various ways to change the colors of the bars. You can manually indicate the colors you want to use but you can also easily use pre-determined color palettes that are already checked for color-blind friendliness.\n\nA popular palette is **viridis**. We can simply add a function/layer to your ggplot named `scale_fill_viridis_d()` (d for discrete). The function hast 5 color options (A - E).\n\n-   Type and run the below code into a new code chunk. Try changing the option to either A, B, C or D and see which one you like!\n\n\n::: {.cell output-location='column-fragment'}\n\n```{.r .cell-code  code-line-numbers=\"7\"}\n#\nggplot(sd_long2, aes(x = gender, fill=gender)) +   \n  geom_bar(show.legend = FALSE) +   \n  scale_x_discrete(name = \"Participant Sex\",                     \n                   labels = c(\"Female\", \"Male\")) +   \n  scale_y_continuous(name = \"Number of participants\") +   \n  theme_minimal() +   \n  scale_fill_viridis_d(option = \"E\") \n```\n\n::: {.cell-output-display}\n![](W4_WrangleViz_files/figure-revealjs/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n\n\n## Transparency\n\nYou can also add transparency to your plot, which can be helpful if you plot several layers of data.\n\nTo do so, you can simply add `alpha` to the `geom_bar()`:\n\n\n::: {.cell output-location='column-fragment'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nggplot(sd_long2, aes(x = gender, fill=gender)) +   \ngeom_bar(show.legend = FALSE,            \n         alpha = .8) +   \n  scale_x_discrete(name = \"Participant Sex\",                    \n                   labels = c(\"Female\", \"Male\")) +   \n  scale_y_continuous(name = \"Number of participants\") +  \n  theme_minimal() +   \n  scale_fill_viridis_d(option = \"E\") \n```\n\n::: {.cell-output-display}\n![](W4_WrangleViz_files/figure-revealjs/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n\n\n## \n",
    "supporting": [
      "W4_WrangleViz_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    // dispatch for htmlwidgets\r\n    function fireSlideEnter() {\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n    }\r\n\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n      fireSlideEnter();\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}